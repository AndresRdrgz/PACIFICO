<!-- Nivel de Endeudamiento -->
       
<div class="flex-1 p-4 border border-gray-400 rounded-lg mb-4">
    <div class="flex items-center ">
        <h1 class="text-lg font-bold">Movimientos Bancarios</h1>
        <div class="ml-auto">
            <label class="inline-flex items-center ms-5 cursor-pointer">
                <input type="checkbox" id="toggleMovimientos" class="sr-only peer" onchange="toggleMovimientosSection()">
                <div class="relative w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-700 peer-focus:ring-4 peer-focus:ring-green-300 dark:peer-focus:ring-green-800 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-green-600"></div>
            </label>
        </div>
    </div>
    <div id="sectionMovimientos" class="flex-1 p-1 rounded-lg" style="display: none;">

        <div class="flex space-x-4 items-end">
            <div class="flex-1 mb-4">
            <label for="id_movPrimerMes" class="block text-sm font-medium text-gray-700 mb-1">Seleccione el primer mes</label>
            {{form.movPrimerMes}}
            </div>
            <div class="flex-1 mb-4">
                <label for="id_movOpcion" class="block text-sm font-medium text-gray-700 mb-1">Â¿Desea utilizar el valor promedio?</label>
                {{form.movOpcion}}
            </div>
            <div class="flex-1 mb-4">
            <button type="button" id="calculateButton" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                Calcular Promedios
            </button>
            </div>

          
        </div>
      

        <div id="movimientosCampos" class="flex overflow-x-auto space-x-4 p-4 mb-4">
            <div class="flex-none w-64">
                <div class="max-w-xs mx-auto mt-2">
                    <!-- Title Section -->
                    <div id="mes1" class="bg-black text-center text-white font-bold text-sm rounded-t-md py-1">
                        MES 1
                    </div>
                    <!-- Ingresos & Egresos -->
                    <div class="grid grid-cols-2 border border-gray-300 rounded-b-md">
                        <!-- Ingresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-green-200">INGRESOS</div>
                            {{ form.ingresosMes1 }}
                        </div>
                        <!-- Egresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-red-200">EGRESOS</div>
                            {{ form.egresosMes1 }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-none w-64">
                <div class="max-w-xs mx-auto mt-2">
                    <!-- Title Section -->
                    <div id="mes2" class="bg-black text-center text-white font-bold text-sm rounded-t-md py-1">
                        MES 2
                    </div>
                    <!-- Ingresos & Egresos -->
                    <div class="grid grid-cols-2 border border-gray-300 rounded-b-md">
                        <!-- Ingresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-green-200">INGRESOS</div>
                            {{ form.ingresosMes2 }}
                        </div>
                        <!-- Egresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-red-200">EGRESOS</div>
                            {{ form.egresosMes2 }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-none w-64">
                <div class="max-w-xs mx-auto mt-2">
                    <!-- Title Section -->
                    <div id="mes3" class="bg-black text-center text-white font-bold text-sm rounded-t-md py-1">
                        MES 3
                    </div>
                    <!-- Ingresos & Egresos -->
                    <div class="grid grid-cols-2 border border-gray-300 rounded-b-md">
                        <!-- Ingresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-green-200">INGRESOS</div>
                            {{ form.ingresosMes3 }}
                        </div>
                        <!-- Egresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-red-200">EGRESOS</div>
                            {{ form.egresosMes3 }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-none w-64">
                <div class="max-w-xs mx-auto mt-2">
                    <!-- Title Section -->
                    <div id="mes4" class="bg-black text-center text-white font-bold text-sm rounded-t-md py-1">
                        MES 4
                    </div>
                    <!-- Ingresos & Egresos -->
                    <div class="grid grid-cols-2 border border-gray-300 rounded-b-md">
                        <!-- Ingresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-green-200">INGRESOS</div>
                            {{ form.ingresosMes4 }}
                        </div>
                        <!-- Egresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-red-200">EGRESOS</div>
                            {{ form.egresosMes4 }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-none w-64">
                <div class="max-w-xs mx-auto mt-2">
                    <!-- Title Section -->
                    <div id="mes5" class="bg-black text-center text-white font-bold text-sm rounded-t-md py-1">
                        MES 5
                    </div>
                    <!-- Ingresos & Egresos -->
                    <div class="grid grid-cols-2 border border-gray-300 rounded-b-md">
                        <!-- Ingresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-green-200">INGRESOS</div>
                            {{ form.ingresosMes5 }}
                        </div>
                        <!-- Egresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-red-200">EGRESOS</div>
                            {{ form.egresosMes5 }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-none w-64">
                <div class="max-w-xs mx-auto mt-2">
                    <!-- Title Section -->
                    <div id="mes6" class="bg-black text-center text-white font-bold text-sm rounded-t-md py-1">
                        MES 6
                    </div>
                    <!-- Ingresos & Egresos -->
                    <div class="grid grid-cols-2 border border-gray-300 rounded-b-md">
                        <!-- Ingresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-green-200">INGRESOS</div>
                            {{ form.ingresosMes6 }}
                        </div>
                        <!-- Egresos -->
                        <div class="p-1 text-center">
                            <div class="text-xs font-semibold bg-red-200">EGRESOS</div>
                            {{ form.egresosMes6 }}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="max-w-xs mx-auto mt-2">
            <!-- Title Section -->
            <div id="movPromedio" class="bg-black text-center text-white font-bold text-sm rounded-t-md py-1">
               PROMEDIO
            </div>
            <!-- Ingresos, Egresos & Diferencia -->
            <div class="grid grid-cols-3 border border-gray-300 rounded-b-md">
            <!-- Ingresos -->
            <div class="p-1 text-center border">
            <div class="text-xs font-semibold bg-green-200">INGRESOS</div>
            <div id="averageIngresos" class="text-sm border">0</div>
            </div>
            <!-- Egresos -->
            <div class="p-1 text-center border">
            <div class="text-xs font-semibold bg-red-200">EGRESOS</div>
            <div id="averageEgresos" class="text-sm border">0</div>
            </div>
            <!-- Diferencia -->
            <div class="p-1 text-center border">
            <div class="text-xs text-white font-semibold bg-black">DIFERENCIA</div>
            <div id="difference" class="text-sm border">0</div>
            </div>
            </div>
        </div>

          
       

        </div>
    </div>

    <script>
        function toggleMovimientosSection() {
        const section = document.getElementById('sectionMovimientos');
        const checkbox = document.getElementById('toggleMovimientos');
        if (checkbox.checked) {
            section.style.display = 'block';
        } else {
            section.style.display = 'none';
        }
        }

        function updateHeaders() {
        const monthNames = ['ENERO', 'FEBRERO', 'MARZO', 'ABRIL', 'MAYO', 'JUNIO', 'JULIO', 'AGOSTO', 'SEPTIEMBRE', 'OCTUBRE', 'NOVIEMBRE', 'DICIEMBRE'];
        const selectedMonth = document.getElementById('id_movPrimerMes').value;
        const startIndex = monthNames.indexOf(selectedMonth);

        if (startIndex !== -1) {
            for (let i = 0; i < 6; i++) {
            const monthIndex = (startIndex - i + 12) % 12;
            document.getElementById(`mes${i + 1}`).innerText = monthNames[monthIndex];
            }
        }
        }
        function calculateAverages() {
        const ingresos = [];
        const egresos = [];
        
        for (let i = 1; i <= 6; i++) {
            const ingresoValue = parseFloat(document.querySelector(`[name="ingresosMes${i}"]`).value) || 0;
            const egresoValue = parseFloat(document.querySelector(`[name="egresosMes${i}"]`).value) || 0;
            if (ingresoValue !== 0 || egresoValue !== 0) {
            ingresos.push(ingresoValue);
            egresos.push(egresoValue);
            }
        }
        
        const averageIngresos = ingresos.reduce((a, b) => a + b, 0) / (ingresos.length || 1);
        const averageEgresos = egresos.reduce((a, b) => a + b, 0) / (egresos.length || 1);
        const difference = averageIngresos - averageEgresos;
        
        document.getElementById('averageIngresos').innerText = averageIngresos.toFixed(2);
        document.getElementById('averageEgresos').innerText = averageEgresos.toFixed(2);
        document.getElementById('difference').innerText = difference.toFixed(2);
        }
        
        document.getElementById('calculateButton').addEventListener('click', calculateAverages);

        document.getElementById('id_movPrimerMes').addEventListener('change', updateHeaders);
        
        calculateAverages();
    
    </script>
