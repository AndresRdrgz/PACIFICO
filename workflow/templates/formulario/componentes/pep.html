{# formulario/componentes/pep.html #}
<div id="pep-seccion" class="flex flex-col gap-8">

  <!-- ¿Es usted una Persona Expuesta Políticamente (PEP)? -->
  <div class="bg-white rounded-xl shadow-md border-l-8 border-green-500 p-5 flex flex-col md:flex-row items-start md:items-center gap-4">
    <div class="flex items-center gap-3 flex-1">
      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-green-100 text-green-600 text-xl">
        <i class="fa-solid fa-user-shield text-green-500"></i>
      </span>
      <label class="font-semibold text-lg md:text-xl block" for="pep_toggle" style="color:#009c3c;">
        ¿Es usted una Persona Expuesta Políticamente (PEP)?
      </label>
    </div>
    <div class="flex items-center mt-3 md:mt-0">
      <label class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" id="pep_toggle" class="sr-only peer">
        <div class="w-14 h-7 bg-gray-200 rounded-full peer peer-checked:bg-green-500 transition-all duration-200"></div>
        <div class="absolute left-1 top-1 w-5 h-5 bg-white rounded-full shadow peer-checked:translate-x-7 transition-transform duration-200"></div>
      </label>
      <span id="pep_label" class="ml-4 text-base font-medium text-gray-700">No</span>
    </div>
    <input type="checkbox" name="{{ form.es_pep.html_name }}" id="{{ form.es_pep.id_for_label }}" value="true" class="hidden" {% if form.es_pep.value %}checked{% endif %}>
  </div>

  <!-- Sección PEP (campos) -->
  <div id="pep-fields-section" class="transition-all duration-300 mt-2" style="display:none;">
    <div class="bg-gray-50 rounded-xl p-6 shadow-inner border border-green-100">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Ingreso mensual PEP -->
        <div>
          <label for="{{ form.pep_ingreso.id_for_label }}" class="block font-semibold mb-1">Ingreso mensual por cargo PEP</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-dollar-sign"></i></span>
            <input
              type="number"
              step="0.01"
              name="{{ form.pep_ingreso.html_name }}"
              id="{{ form.pep_ingreso.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              placeholder="Ingreso mensual"
              value="{{ form.pep_ingreso.value|default_if_none:'' }}"
            >
          </div>
          {% if form.pep_ingreso.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.pep_ingreso.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Fecha de inicio del cargo -->
        <div>
          <label for="{{ form.pep_inicio.id_for_label }}" class="block font-semibold mb-1">Fecha de inicio del cargo</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-calendar-alt"></i></span>
            <input
              type="date"
              name="{{ form.pep_inicio.html_name }}"
              id="{{ form.pep_inicio.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              value="{{ form.pep_inicio.value|default_if_none:'' }}"
            >
          </div>
          {% if form.pep_inicio.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.pep_inicio.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Cargo actual -->
        <div>
          <label for="{{ form.pep_cargo_actual.id_for_label }}" class="block font-semibold mb-1">Cargo actual</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-briefcase"></i></span>
            <input
              type="text"
              name="{{ form.pep_cargo_actual.html_name }}"
              id="{{ form.pep_cargo_actual.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              placeholder="Cargo actual"
              value="{{ form.pep_cargo_actual.value|default_if_none:'' }}"
            >
          </div>
          {% if form.pep_cargo_actual.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.pep_cargo_actual.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Fecha de finalización del cargo -->
        <div>
          <label for="{{ form.pep_fin.id_for_label }}" class="block font-semibold mb-1">Fecha de finalización del cargo</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-calendar-alt"></i></span>
            <input
              type="date"
              name="{{ form.pep_fin.html_name }}"
              id="{{ form.pep_fin.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              value="{{ form.pep_fin.value|default_if_none:'' }}"
            >
          </div>
          {% if form.pep_fin.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.pep_fin.errors|striptags }}</div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- ¿Es usted familiar de una persona PEP? -->
  <div class="bg-white rounded-xl shadow-md border-l-8 border-green-500 p-5 flex flex-col md:flex-row items-start md:items-center gap-4">
    <div class="flex items-center gap-3 flex-1">
      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-green-100 text-green-600 text-xl">
        <i class="fa-solid fa-user-friends text-green-500"></i>
      </span>
      <label class="font-semibold text-lg md:text-xl block" for="familiar_pep_toggle" style="color:#009c3c;">
        ¿Es usted familiar de una persona PEP?
      </label>
    </div>
    <div class="flex items-center mt-3 md:mt-0">
      <label class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" id="familiar_pep_toggle" class="sr-only peer">
        <div class="w-14 h-7 bg-gray-200 rounded-full peer peer-checked:bg-green-500 transition-all duration-200"></div>
        <div class="absolute left-1 top-1 w-5 h-5 bg-white rounded-full shadow peer-checked:translate-x-7 transition-transform duration-200"></div>
      </label>
      <span id="familiar_pep_label" class="ml-4 text-base font-medium text-gray-700">No</span>
    </div>
    <input type="checkbox" name="{{ form.es_familiar_pep.html_name }}" id="{{ form.es_familiar_pep.id_for_label }}" value="true" class="hidden" {% if form.es_familiar_pep.value %}checked{% endif %}>
  </div>

  <!-- Sección Familiar de PEP -->
  <div id="familiar-pep-fields-section" class="transition-all duration-300 mt-2" style="display:none;">
    <div class="bg-gray-50 rounded-xl p-6 shadow-inner border border-green-100">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Parentesco -->
        <div>
          <label for="{{ form.parentesco_pep.id_for_label }}" class="block font-semibold mb-1">Parentesco</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-user-friends"></i></span>
            <input
              type="text"
              name="{{ form.parentesco_pep.html_name }}"
              id="{{ form.parentesco_pep.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              placeholder="Parentesco"
              value="{{ form.parentesco_pep.value|default_if_none:'' }}"
            >
          </div>
          {% if form.parentesco_pep.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.parentesco_pep.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Nombre del PEP -->
        <div>
          <label for="{{ form.nombre_pep.id_for_label }}" class="block font-semibold mb-1">Nombre del PEP</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-id-badge"></i></span>
            <input
              type="text"
              name="{{ form.nombre_pep.html_name }}"
              id="{{ form.nombre_pep.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              placeholder="Nombre del PEP"
              value="{{ form.nombre_pep.value|default_if_none:'' }}"
            >
          </div>
          {% if form.nombre_pep.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.nombre_pep.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Cargo del PEP -->
        <div>
          <label for="{{ form.cargo_pep.id_for_label }}" class="block font-semibold mb-1">Cargo que desempeña</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-briefcase"></i></span>
            <input
              type="text"
              name="{{ form.cargo_pep.html_name }}"
              id="{{ form.cargo_pep.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              placeholder="Cargo del PEP"
              value="{{ form.cargo_pep.value|default_if_none:'' }}"
            >
          </div>
          {% if form.cargo_pep.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.cargo_pep.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Institución donde labora -->
        <div>
          <label for="{{ form.institucion_pep.id_for_label }}" class="block font-semibold mb-1">Institución donde labora</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-building"></i></span>
            <input
              type="text"
              name="{{ form.institucion_pep.html_name }}"
              id="{{ form.institucion_pep.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              placeholder="Institución"
              value="{{ form.institucion_pep.value|default_if_none:'' }}"
            >
          </div>
          {% if form.institucion_pep.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.institucion_pep.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Fecha inicio familiar -->
        <div>
          <label for="{{ form.pep_fam_inicio.id_for_label }}" class="block font-semibold mb-1">Fecha de inicio</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-calendar-alt"></i></span>
            <input
              type="date"
              name="{{ form.pep_fam_inicio.html_name }}"
              id="{{ form.pep_fam_inicio.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              value="{{ form.pep_fam_inicio.value|default_if_none:'' }}"
            >
          </div>
          {% if form.pep_fam_inicio.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.pep_fam_inicio.errors|striptags }}</div>
          {% endif %}
        </div>
        <!-- Fecha fin familiar -->
        <div>
          <label for="{{ form.pep_fam_fin.id_for_label }}" class="block font-semibold mb-1">Fecha de finalización</label>
          <div class="flex items-center border rounded-lg bg-white px-3 py-2">
            <span class="mr-2 text-green-500"><i class="fa-solid fa-calendar-alt"></i></span>
            <input
              type="date"
              name="{{ form.pep_fam_fin.html_name }}"
              id="{{ form.pep_fam_fin.id_for_label }}"
              class="flex-1 outline-none bg-transparent"
              value="{{ form.pep_fam_fin.value|default_if_none:'' }}"
            >
          </div>
          {% if form.pep_fam_fin.errors %}
            <div class="text-red-600 text-xs mt-1">{{ form.pep_fam_fin.errors|striptags }}</div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Toggle PEP
    const pepToggle = document.getElementById('pep_toggle');
    const pepSection = document.getElementById('pep-fields-section');
    const pepLabel = document.getElementById('pep_label');
    const pepHidden = document.getElementById('{{ form.es_pep.id_for_label }}');
    pepToggle.checked = pepHidden.checked;
    pepLabel.textContent = pepToggle.checked ? 'Sí' : 'No';
    pepToggle.addEventListener('change', function() {
      pepHidden.checked = this.checked;
      pepSection.style.display = this.checked ? 'block' : 'none';
      pepLabel.textContent = this.checked ? 'Sí' : 'No';
    });

    // Toggle Familiar PEP
    const familiarPepToggle = document.getElementById('familiar_pep_toggle');
    const familiarPepSection = document.getElementById('familiar-pep-fields-section');
    const familiarPepLabel = document.getElementById('familiar_pep_label');
    const familiarPepHidden = document.getElementById('{{ form.es_familiar_pep.id_for_label }}');
    familiarPepToggle.checked = familiarPepHidden.checked;
    familiarPepLabel.textContent = familiarPepToggle.checked ? 'Sí' : 'No';
    familiarPepToggle.addEventListener('change', function() {
      familiarPepHidden.checked = this.checked;
      familiarPepSection.style.display = this.checked ? 'block' : 'none';
      familiarPepLabel.textContent = this.checked ? 'Sí' : 'No';
    });

    // Sincroniza si ya hay datos cargados
    if (pepHidden.checked) {
      pepSection.style.display = 'block';
      pepToggle.checked = true;
      pepLabel.textContent = 'Sí';
    }
    if (familiarPepHidden.checked) {
      familiarPepSection.style.display = 'block';
      familiarPepToggle.checked = true;
      familiarPepLabel.textContent = 'Sí';
    }
    pepHidden.style.display = 'none';
    familiarPepHidden.style.display = 'none';
  });
</script>