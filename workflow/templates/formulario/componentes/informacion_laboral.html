{# formulario/componentes/informacion_laboral.html #}
<div id="informacion-laboral-seccion" class="form-section">
  <div class="row g-4">

    <!-- Dirección del trabajo -->
    <div class="col-12">
      <label for="{{ form.trabajo_direccion.id_for_label }}">Dirección del trabajo</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-map-marked-alt text-muted"></i></span>
        <textarea
          name="{{ form.trabajo_direccion.html_name }}"
          id="{{ form.trabajo_direccion.id_for_label }}"
          class="form-control"
          placeholder="Dirección del trabajo"
          rows="3"
        >{{ form.trabajo_direccion.value|default_if_none:'' }}</textarea>
      </div>
      {% if form.trabajo_direccion.errors %}
        <div class="text-danger small mt-1">{{ form.trabajo_direccion.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Lugar -->
    <div class="col-md-6">
      <label for="{{ form.trabajo_lugar.id_for_label }}">Lugar</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-building text-muted"></i></span>
        <input
          type="text"
          name="{{ form.trabajo_lugar.html_name }}"
          id="{{ form.trabajo_lugar.id_for_label }}"
          class="form-control"
          placeholder="Lugar de trabajo"
          value="{{ form.trabajo_lugar.value|default_if_none:'' }}"
        >
      </div>
      {% if form.trabajo_lugar.errors %}
        <div class="text-danger small mt-1">{{ form.trabajo_lugar.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Cargo Actual -->
    <div class="col-md-6">
      <label for="{{ form.trabajo_cargo.id_for_label }}">Cargo Actual</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-user-tie text-muted"></i></span>
        <input
          type="text"
          name="{{ form.trabajo_cargo.html_name }}"
          id="{{ form.trabajo_cargo.id_for_label }}"
          class="form-control"
          placeholder="Cargo actual"
          value="{{ form.trabajo_cargo.value|default_if_none:'' }}"
        >
      </div>
      {% if form.trabajo_cargo.errors %}
        <div class="text-danger small mt-1">{{ form.trabajo_cargo.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Salario -->
    <div class="col-md-6">
      <label for="{{ form.salario.id_for_label }}">Salario</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-dollar-sign text-muted"></i></span>
        <input
          type="number"
          step="0.01"
          name="{{ form.salario.html_name }}"
          id="{{ form.salario.id_for_label }}"
          class="form-control"
          placeholder="Salario"
          value="{{ form.salario.value|default_if_none:'' }}"
        >
      </div>
      {% if form.salario.errors %}
        <div class="text-danger small mt-1">{{ form.salario.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Tipo de Trabajo -->
    <div class="col-md-6">
      <label for="{{ form.tipo_trabajo.id_for_label }}">Tipo de Trabajo</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-briefcase text-muted"></i></span>
        {{ form.tipo_trabajo }}
      </div>
      {% if form.tipo_trabajo.errors %}
        <div class="text-danger small mt-1">{{ form.tipo_trabajo.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Origen de los Fondos -->
    <div class="col-md-6">
      <label for="{{ form.origen_fondos.id_for_label }}">Origen de los Fondos</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-wallet text-muted"></i></span>
        {{ form.origen_fondos }}
      </div>
      {% if form.origen_fondos.errors %}
        <div class="text-danger small mt-1">{{ form.origen_fondos.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Frecuencia de Pago -->
    <div class="col-md-6">
      <label for="{{ form.frecuencia_pago.id_for_label }}">Frecuencia</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-calendar-alt text-muted"></i></span>
        {{ form.frecuencia_pago }}
      </div>
      {% if form.frecuencia_pago.errors %}
        <div class="text-danger small mt-1">{{ form.frecuencia_pago.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Teléfono de trabajo -->
    <div class="col-md-6">
      <label for="{{ form.tel_trabajo.id_for_label }}">Teléfono de Trabajo</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-phone text-muted"></i></span>
        <input
          type="text"
          name="{{ form.tel_trabajo.html_name }}"
          id="{{ form.tel_trabajo.id_for_label }}"
          class="form-control"
          placeholder="0000-0000"
          value="{{ form.tel_trabajo.value|default_if_none:'' }}"
        >
      </div>
      {% if form.tel_trabajo.errors %}
        <div class="text-danger small mt-1">{{ form.tel_trabajo.errors|striptags }}</div>
      {% endif %}
    </div>

    <!-- Extensión -->
    <div class="col-md-6">
      <label for="{{ form.tel_ext.id_for_label }}">Extensión</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-phone-alt text-muted"></i></span>
        <input
          type="text"
          name="{{ form.tel_ext.html_name }}"
          id="{{ form.tel_ext.id_for_label }}"
          class="form-control"
          placeholder="Extensión"
          value="{{ form.tel_ext.value|default_if_none:'' }}"
        >
      </div>
      {% if form.tel_ext.errors %}
        <div class="text-danger small mt-1">{{ form.tel_ext.errors|striptags }}</div>
      {% endif %}
    </div>
  </div>

  <!-- Toggle + Sección de otros ingresos -->
  <div class="row g-4 mt-4">
    <div class="col-12">
      <div class="p-4 rounded-3 shadow-sm mb-4 bg-white border" style="border-left: 5px solid #00c86b;">
        <label class="fw-semibold mb-2" for="otros_ingresos_toggle" style="font-size:1.15rem; color:#009c3c;">
          <i class="fas fa-plus-circle me-2"></i>¿Tiene otros ingresos?
        </label>
        <div class="form-check form-switch d-inline-block ms-3" style="font-size:1.2rem;">
          <input class="form-check-input" type="checkbox" id="otros_ingresos_toggle" style="width:2.5em;height:1.5em;">
          <label class="form-check-label ms-2" for="otros_ingresos_toggle" id="otros_ingresos_label" style="font-size:1.08rem; color:#444;">No</label>
        </div>
        <span class="text-muted ms-3" style="font-size:0.98rem;">Activa el interruptor si tienes otros ingresos</span>
      </div>
    </div>
  </div>

  <div id="otros-ingresos-section" style="display:none;">
    {{ otros_ingresos_formset.management_form }}
    {% for form in otros_ingresos_formset %}
      <div class="otros-ingreso-form mb-4 pb-3 border-bottom">
        <h5 class="text-success fw-semibold mb-3">
          <i class="fas fa-coins me-1"></i> Otro Ingreso {{ forloop.counter }}
        </h5>
        <div class="row g-4">
          <div class="col-md-6">
            <label for="{{ form.fuente.id_for_label }}">Fuente</label>
            {{ form.fuente }}
            {% if form.fuente.errors %}
              <div class="text-danger small mt-1">{{ form.fuente.errors|striptags }}</div>
            {% endif %}
          </div>
          <div class="col-md-6">
            <label for="{{ form.monto.id_for_label }}">Monto mensual</label>
            {{ form.monto }}
            {% if form.monto.errors %}
              <div class="text-danger small mt-1">{{ form.monto.errors|striptags }}</div>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const toggleOtros = document.getElementById('otros_ingresos_toggle');
      const otrosSection = document.getElementById('otros-ingresos-section');
      const labelOtros = document.getElementById('otros_ingresos_label');

      toggleOtros.checked = false;
      otrosSection.style.display = 'none';
      labelOtros.textContent = 'No';

      toggleOtros.addEventListener('change', function() {
        if (this.checked) {
          otrosSection.style.display = 'block';
          labelOtros.textContent = 'Sí';
        } else {
          otrosSection.style.display = 'none';
          labelOtros.textContent = 'No';
        }
      });

      const inputs = otrosSection.querySelectorAll('input, select');
      let hasValue = false;
      inputs.forEach(input => {
        if (input.value) hasValue = true;
      });

      if (hasValue) {
        toggleOtros.checked = true;
        otrosSection.style.display = 'block';
        labelOtros.textContent = 'Sí';
      }
    });
  </script>
</div>
