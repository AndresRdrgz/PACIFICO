{# formulario/componentes/autorizaciones.html #}
<div id="autorizaciones-seccion" class="flex flex-col gap-6 mt-4">

  <!-- ¿Autoriza revisión de APC? -->
  <div class="bg-white rounded-xl shadow-md border-l-8 border-green-500 p-5 flex flex-col md:flex-row items-start md:items-center gap-4">
    <div class="flex items-center gap-3 flex-1">
      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-green-100 text-green-600 text-xl">
        <i class="fa-solid fa-user-check"></i>
      </span>
      <div>
        <label class="font-semibold text-lg md:text-xl block" for="autoriza_apc_toggle" style="color:#009c3c;">
          ¿Nos autorizas a revisar tu APC?
        </label>
        <small class="text-gray-500 block">Artículo 23 de la Ley 24 del 22 de mayo del 2002</small>
      </div>
    </div>
    <div class="flex items-center mt-3 md:mt-0">
      <label class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" id="autoriza_apc_toggle" class="sr-only peer">
        <div class="w-14 h-7 bg-gray-200 rounded-full peer peer-checked:bg-green-500 transition-all duration-200"></div>
        <div class="absolute left-1 top-1 w-5 h-5 bg-white rounded-full shadow peer-checked:translate-x-7 transition-transform duration-200"></div>
      </label>
      <span id="autoriza_apc_label" class="ml-4 text-base font-medium text-gray-700">No</span>
    </div>
    <input type="hidden" name="{{ form.autoriza_apc.html_name }}" id="autoriza_apc_hidden" value="{% if form.autoriza_apc.value %}VERDADERO{% else %}FALSO{% endif %}">
  </div>

  <!-- ¿Acepta tratamiento de datos? -->
  <div class="bg-white rounded-xl shadow-md border-l-8 border-green-500 p-5 flex flex-col md:flex-row items-start md:items-center gap-4">
    <div class="flex items-center gap-3 flex-1">
      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-green-100 text-green-600 text-xl">
        <i class="fa-solid fa-user-lock"></i>
      </span>
      <div>
        <label class="font-semibold text-lg md:text-xl block" for="acepta_datos_toggle" style="color:#009c3c;">
          Acepto permitir a Pacífico Préstamos almacenar y procesar mis datos personales.
        </label>
        <small class="text-gray-500 block">Ley 81 del 2019 y su reglamentación</small>
      </div>
    </div>
    <div class="flex items-center mt-3 md:mt-0">
      <label class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" id="acepta_datos_toggle" class="sr-only peer">
        <div class="w-14 h-7 bg-gray-200 rounded-full peer peer-checked:bg-green-500 transition-all duration-200"></div>
        <div class="absolute left-1 top-1 w-5 h-5 bg-white rounded-full shadow peer-checked:translate-x-7 transition-transform duration-200"></div>
      </label>
      <span id="acepta_datos_label" class="ml-4 text-base font-medium text-gray-700">No</span>
    </div>
    <input type="hidden" name="{{ form.acepta_datos.html_name }}" id="acepta_datos_hidden" value="{% if form.acepta_datos.value %}VERDADERO{% else %}FALSO{% endif %}">
  </div>

  <!-- ¿Es beneficiario final? -->
  <div class="bg-white rounded-xl shadow-md border-l-8 border-green-500 p-5 flex flex-col md:flex-row items-start md:items-center gap-4">
    <div class="flex items-center gap-3 flex-1">
      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-green-100 text-green-600 text-xl">
        <i class="fa-solid fa-user-tag"></i>
      </span>
      <div>
        <label class="font-semibold text-lg md:text-xl block" for="es_beneficiario_final_toggle" style="color:#009c3c;">
          Declaro que soy el beneficiario final del crédito.
        </label>
      </div>
    </div>
    <div class="flex items-center mt-3 md:mt-0">
      <label class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" id="es_beneficiario_final_toggle" class="sr-only peer">
        <div class="w-14 h-7 bg-gray-200 rounded-full peer peer-checked:bg-green-500 transition-all duration-200"></div>
        <div class="absolute left-1 top-1 w-5 h-5 bg-white rounded-full shadow peer-checked:translate-x-7 transition-transform duration-200"></div>
      </label>
      <span id="es_beneficiario_final_label" class="ml-4 text-base font-medium text-gray-700">No</span>
    </div>
    <input type="hidden" name="{{ form.es_beneficiario_final.html_name }}" id="es_beneficiario_final_hidden" value="{% if form.es_beneficiario_final.value %}VERDADERO{% else %}FALSO{% endif %}">
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Autoriza APC
    const apcToggle = document.getElementById('autoriza_apc_toggle');
    const apcLabel = document.getElementById('autoriza_apc_label');
    const apcHidden = document.getElementById('autoriza_apc_hidden');
    apcToggle.checked = apcHidden.value === 'VERDADERO';
    apcLabel.textContent = apcToggle.checked ? 'Sí' : 'No';
    apcToggle.addEventListener('change', function() {
      apcHidden.value = this.checked ? 'VERDADERO' : 'FALSO';
      apcLabel.textContent = this.checked ? 'Sí' : 'No';
    });

    // Acepta datos
    const datosToggle = document.getElementById('acepta_datos_toggle');
    const datosLabel = document.getElementById('acepta_datos_label');
    const datosHidden = document.getElementById('acepta_datos_hidden');
    datosToggle.checked = datosHidden.value === 'VERDADERO';
    datosLabel.textContent = datosToggle.checked ? 'Sí' : 'No';
    datosToggle.addEventListener('change', function() {
      datosHidden.value = this.checked ? 'VERDADERO' : 'FALSO';
      datosLabel.textContent = this.checked ? 'Sí' : 'No';
    });

    // Beneficiario final
    const benToggle = document.getElementById('es_beneficiario_final_toggle');
    const benLabel = document.getElementById('es_beneficiario_final_label');
    const benHidden = document.getElementById('es_beneficiario_final_hidden');
    benToggle.checked = benHidden.value === 'VERDADERO';
    benLabel.textContent = benToggle.checked ? 'Sí' : 'No';
    benToggle.addEventListener('change', function() {
      benHidden.value = this.checked ? 'VERDADERO' : 'FALSO';
      benLabel.textContent = this.checked ? 'Sí' : 'No';
    });
  });
</script>
